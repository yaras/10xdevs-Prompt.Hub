@using MudBlazor
@using PromptHub.Web.Application.Models.Prompts
@using PromptHub.Web.Application.Models.Votes

<MudCard>
    <MudCardHeader>
        <CardHeaderContent>
            <MudText Typo="Typo.h6">@this.Prompt.Title</MudText>
        </CardHeaderContent>
        <CardHeaderActions>
            <MudIconButton Icon="@Icons.Material.Filled.Visibility" Color="Color.Default" OnClick="this.ViewClicked" />
            @if (this.ShowEdit)
            {
                <MudIconButton Icon="@Icons.Material.Filled.Edit" Color="Color.Default" OnClick="this.EditClicked" />
            }
        </CardHeaderActions>
    </MudCardHeader>

    <MudCardContent>
        @if (!string.IsNullOrWhiteSpace(this.Prompt.AuthorEmail))
        {
            <MudText Typo="Typo.caption" Color="Color.Secondary" Class="mb-2">@this.Prompt.AuthorEmail</MudText>
        }

        <MudStack Row="true" Spacing="1" Class="mb-2" Style="flex-wrap:wrap;">
            @foreach (var tag in this.Prompt.Tags)
            {
                <MudChip T="string" Size="Size.Small" Variant="Variant.Outlined">@tag</MudChip>
            }
        </MudStack>

        <MudStack Row="true" Justify="Justify.SpaceBetween" AlignItems="AlignItems.Center">
            <MudChip T="string" Size="Size.Small" Color="@(this.Prompt.Visibility == PromptVisibility.Public ? Color.Success : Color.Default)">
                @this.Prompt.Visibility
            </MudChip>
            <MudText Typo="Typo.caption" Color="Color.Secondary">
                Updated @this.Prompt.UpdatedAt.ToLocalTime().ToString("yyyy-MM-dd")
            </MudText>
        </MudStack>
    </MudCardContent>

    <MudCardActions>
        <MudStack Row="true" Spacing="2">
            @if (this.ShowVoting)
            {
                <MudButton StartIcon="@Icons.Material.Filled.ThumbUp"
                           Size="Size.Small"
                           Color="Color.Success"
                           Variant="@(this.Prompt.UserVote == VoteValue.Like ? Variant.Filled : Variant.Outlined)"
                           OnClick="this.LikeClicked">
                    @this.Prompt.Likes
                </MudButton>
                <MudButton StartIcon="@Icons.Material.Filled.ThumbDown"
                           Size="Size.Small"
                           Color="Color.Error"
                           Variant="@(this.Prompt.UserVote == VoteValue.Dislike ? Variant.Filled : Variant.Outlined)"
                           OnClick="this.DislikeClicked">
                    @this.Prompt.Dislikes
                </MudButton>
            }
            else
            {
                <MudButton StartIcon="@Icons.Material.Filled.ThumbUp" Size="Size.Small" Color="Color.Success" Disabled="true">
                    @this.Prompt.Likes
                </MudButton>
                <MudButton StartIcon="@Icons.Material.Filled.ThumbDown" Size="Size.Small" Color="Color.Error" Disabled="true">
                    @this.Prompt.Dislikes
                </MudButton>
            }
        </MudStack>
    </MudCardActions>
</MudCard>


